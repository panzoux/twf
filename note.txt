Install cmigemo:
Windows: Download from KaoriYa
Linux: sudo apt-get install cmigemo
macOS: brew install cmigemo
Run TWF and check logs for "Migemo search enabled"
Use search mode (Ctrl+S) with romaji to find Japanese files

fix: "dict/utf8/migemo-dict" replace "++" with "\+\+" so that we can search "c"

---

Non-Reloadable Settings (Requires Restart)
Migemo: Dictionary path and enabled status.
Logging: Log level and providers.


* Log Visuals:
  - Implement LogLevel colors.
  - Implement Auto-scrolling toggle.

* LINQ Removal & Performance (Major):
  - Completely removed System.Linq from core codebase for optimization.
  - Fixed NREs and key interception regressions from refactoring.
  - Standardized dialog focus colors (Black/Gray normal, White/DarkGray focus).
  - Implemented "Prepared Search" pattern: Expanded Migemo tokens and Compiled Regex exactly once per search keystroke.
  - Massive speedup in JumpToFile/JumpToPath search.
  - Refactored Marking Logic: Unified MarkAll/Clear/Invert into a DRY method.
  - Added Ctrl+K (Clear Marks) and Shift+A (Invert Marks).
  - Ensured '..' is never marked and status bar is updated for all marking actions.
  - Refactored Pane Sync: Unified logic into SyncPanePaths helper.
  - Added 'o' (Sync current with opposite), Shift+O (Sync opposite with current), and Ctrl+O (Swap panes).
  - Removed internal Image Viewer and System.Drawing dependency.
  - Image viewing is now handled via a custom function named 'ImageViewer' (supporting full macro expansion like $P\$F).
  - ShowVersionInfo (F1) provides instructions on how to configure 'ImageViewer'.

---
**done**
at starting t2: Started - JobID:0f8fad5b-d9cb-469f-a165-70867728950e"

when deleteing a directory "delete 1 file(s) " dialog is shown. should use proper name and pluralization:
- when deleting file : "1 file"  "2 files"
- when deleting directory : "1 directory" "2 directories"
- when deleting 1 file and 2 directories : "2 directories, 1 file"

* Job Progress Refinement:
  - Separate progress stats and filename in JobManagerDialog.
  - Implement recursive file counting for accurate "1/N" progress.
  - Display per-file percentage separately from overall job percentage.
  - Fix "1/1" indexing issue for directory copies.

* Log Persistence:
  - Implement log flushing to file when memory buffer exceeds limit.
  - Save task log on application exit.
  - Manual "Save Log" command.

* Visual Enhancements:
  - Resize JobManagerDialog to 64x24.
  - Implement SmartTruncate for filenames with extensions.
  - Configurable Ellipsis ("...").
  - Colored logs in TaskStatusView (OK/FAIL/WARN).
  - Short Job ID display.


* Job Progress Refinement:
  - Separate progress stats and filename in JobManagerDialog.
  - Implement recursive file counting for accurate "1/N" progress.
  - Display per-file percentage separately from overall job percentage.
  - Fix "1/1" indexing issue for directory copies.

* Log Persistence:
  - Implement log flushing to file when memory buffer exceeds limit.
  - Save task log on application exit.
  - Manual "Save Log" command.

* Visual Enhancements:
  - Resize JobManagerDialog to 64x24.
  - Implement SmartTruncate for filenames with extensions.
  - Configurable Ellipsis ("...").
  - Colored logs in TaskStatusView (OK/FAIL/WARN).
  - Short Job ID display.


viewing large files takes time.
change textviewer, and binaryviewer(may be independent from textviewer so that i can enhance features):
* a high-performance text/binary viewer for massive files (GB+) that uses memory-mapped files, lazy loading
  with chunked reading (1-4MB), virtual scrolling, caching strategy (LRU), async I/O, line indexing for text files,
  efficient data structures (rope/gap buffers), optimized search (Boyer-Moore), UI optimization (double-buffering),
  configurable limits, file type detection, and background processing to ensure responsive operation with large
  files.
* "Esc to stop reading" in taskpanel or asynchronous dialog(continue/cancel) if it takes >10 sec, and allow stop reading 

* textviewer
- if text<1page and TextViewer.PageDown clears the screen. it should stay as there are no more page

* drive dialog:
 - cant select "C:\ xxx" when typing "c" but can select when "c:". why?
 - dont add to drive if the path was unreachable

* refactor
- dialogs ad maincontroller.cs to UI/
- scattered "config loading"
- scattered "loggers"
- message "Configuration reloaded. (Restart required for Migemo and Font settings)."
- for fonts config; i thought is it really available and used? font size and fonts are defined and used from terminal settings and can't be used. in that case we can remove this setting)

* background job dialog: list selected color is same as dialog background and visibility is poor: list color should use 
  -    "ForegroundColor": "White",
  -    "BackgroundColor": "Black",
  -    "HighlightForegroundColor": "Black",
  -    "HighlightBackgroundColor": "Cyan"
* file mask filter dialog: help color should use (DialogHelp[Fore|Back]groundColor)
* wildcard mark dialog: help color should use (DialogHelp[Fore|Back]groundColor)

* display sort order in taskpanel. 
* sort dialog?

* i want reading progress percentage at textviewer window's '_encodinglabel', like: "Reading... 90%", and when reading finishes, clear _encodinglabel

* search ^k clear input

* folder size: dialog? taskpanel? => background job. taskpanel can scroll up

* viewing thousands of files at slow media (SDcard, etc) : Create a high-performance filelist that handles millions of files using
  memory-mapped files, virtual ListView with scrolling, chunked loading (1-4MB), async I/O, line indexing for text,
  efficient terminal rendering, caching (LRU), search optimization, navigation optimization, file type detection, and
  configuration options to maintain Terminal.Gui responsiveness while viewing large files.
* i want progress percentage at main window's '__filenameLabel' rightmost, like: "Loading... 90%", and when finishes, be sure to clear loading indicator

Large File Viewer? Some possibilities:
   * Search Optimization: Making the search asynchronous so it doesn't block the UI for GB-sized files, and adding a "Cancel
     Search" option.
   * Horizontal Scrolling: For files with very long lines (like log entries or minified code).

on quit, if there are any tabs/panes that are in the archive, go back to filesystem, select archive, then quit. when 'leftpane:c:\ rightpane:c:\test\test.zip (virtualfolder)', on quit 'leftpane:c:\ rightpane:c:\test'

"clearmarks"=>
"refreshpane_clearmarks"
"refreshpane_noclearmarks"

we should move twf_errors.log to TWF\logs? where do we keep logs for apps? whats the best practice for win/linux/mac? is %APPDATA%\Roaming\TWF\logs appropriate?

compress dialog: dont show unsupported. 

version number on start

* add to archive name decent extension if not has it

* after delete , filepane is not updated. deleted file stays shown. i want it to be gone

* cancelling "pack to archive" doesnt really stop.

* we shall enhance our help. dynamic help to show defined keybindings with migemo incremental search. we might need another config file for feature/function explanation.(section, function , explanation) (and maybe english/japanese)
that displays formatted content, keybindings from a configuration file, and supports multiple languages. might need HelpView class?


are we using archivedllpaths in the config? (we use dll from path or same as executable)
=> library has that feature.  SetLibraryPath method

job dialog not showing from and to

separator between file panes is 1 row too high!

jumptofile: the program is using filepane's list as a startpoint so that we dont have to re-read millon files, isnt it?
jumptofile: make width 66. add label below the list to show fullpath (size:64*4). show list using smarttruncate.we cant see long path in the dialog
jumptofile: add spinner to line 1. show "no match" at line 1 if search result is none
jumptofile: make it multiple keyword (separator ' ', escaping space='\ ') search
jumptofile: have ignorelist (default: none)

remove linq!

* shift+a : invert marks
* ctrl+k : clearmarks

"ViewFileAsImage" is not implemented. we should have config ImageViewerApp for now and pass the file to it.

syncpanes --renameto-> syncOppositePaneWithCurrentPane
* o : syncCurrentPaneWithOppositePane
* shift+o : syncOppositePaneWithCurrentPane
* ctrl+o : swappanes

swap panes, sync(current|opposite)panewith(opposite|current)pane are changing directories and should be added to the history

turn possible showMessageDialog() into setstatus with dedicated color or format or to the log ([Info]/[Debug]). list up the candidates first, and then suggest deeply thoulght,revised,self-reviewed great ways of doing that, with recommendation %

add function go back history: alt+left, go forward history: alt right. unlike other functions that change directory, this should not be recoreded to history, and keep where we are at the history until next other changing directory operation


--- *** partially done ***

lets have 7z archiving feature. how should we do it? give me plans. but think deeply and we want effective, concise, and best practice pattern to handle
  multiple arvhive formats in lean and clean way (that complies with "readable code")
look for 7z binaries at startup, log and put message to taskstatusview just like migemo, delete entry from compress dialog if unavailable. we
  might add compress level selector at the dialog or have it at the config for each archive format..

warning NU1701: パッケージ 'SevenZipSharp 0.64.0' はプロジェクトのターゲット フレームワー                │
│ ク 'net8.0' ではなく '.NETFra                                                                                                                                │
│ mework,Version=v4.6.1, .NETFramework,Version=v4.6.2, .NETFramework,Version=v4.7, .NETFramework,Version=v4.7.1, .NETFramework,Version=v4.7.2,                 │
│ .NETFramework,Version=v4.8, .NETFramework,Version=v4.8.1' を使用して復元されました。このパッケージは、使用しているプロジェクトとの完全な互換性               │
│ がない可能性があります。


**considered unnecessary**

* auto complete jump to path
 -> we already have fzf like folder/file search, which is useful for jump to path. autocomplete just completes whats there, but you only need some keywords to see/filter at the search dialog

---
---
---
---
---
---
---
**to be fixed/ideas**

textviewer: auto-detect encoding
suggest deeply thought, revised, self-reviewed great ways of doing that, with recommendation %. we will plan first, no coding yet. ​:


list up dialogs that can be changed to use
BaseSearchDialog, enhance it to have parameter for size (width minimum, width%?, and height minimum, height %, what to show?)
-> BaseSearchDialogEnhancement.md


fix: w key compare: and log to taskstatusview each file's compared result

textviewer: auto-detect encoding


job dialog doesnt work out of the box. we need it to cancel job! have default maxsimultaneousjobs?

password for zip/7z : do we really need this???

cant distinguish \(yen) and \(backslash)

remove context menu??? remake it as something useful?

* remove image viewer and system.drawing. (we have completed our new rust-made terminal image viewer!)

* register folder dialog: ability to edit path (so that we can set envvar)

* mark off after file operations

* archive can only see filelist inside. copy/move/delete/view doesnt work (partially done)

* history in jump path dialog? (should go with history?)

* log cleanup script

* remove context menu (for now, as we can make it with custom menu. to be "context" we should have menu for each/certain extensions?)

* on opening editor or running commands, we should show it to the taskstatusview, to let the use know (it looks like it is stuck)

* helper menu for various twf activities

JobManagerDialog: close and cancel has save acceralator key 'c': one should be exit or quit?
JobManagerDialog: do we need buttons here? esc closes, select(up/down) and 'k' to kill job, put help at bottom (DialogHelp[Fore|Back]groundColor)
 

file mask filter dialog: button needed? esc=close, enter=ok
file mask filter dialog: we want match samples list (top 5) in the dialog, list color should use "ForegroundColor","BackgroundColor"

wildcard mark dialog: button needed? esc=close, enter=ok
wildcard mark dialog: we want match samples list (top 5) in the dialog, list color should use "ForegroundColor","BackgroundColor"
wildcard mark dialog:

greetings on certain days!

readline for c#, for command input, direct move to tabs

viewer
   * Advanced Binary Features: Adding the ability to jump to a specific hex offset or edit bytes.
   * Theme/Colors: Customizing the colors for the line numbers vs. content.

ask before delete dialog (file/archive), configurable


    fix: when in zip folder, path display is not truncated to screen's half width
    fix: (difficult) edit cursor is left after dialog,textview, etc
    fix: (difficult) no ProcessKey() is called at dialogs and viewers. Reason why we cant config keys in viewers (some keys work:F1~F12)
    fix: (difficult) cant switch to binary mode using key (B,F7). maybe terminal.gui is taking some keys away and doesnt pass it to the program
    fix(custom_config): twf buf cant jump fzf when path has cjs chars
    fix: help message. should we display from keyconfig.json ? empty)

    feat: progress bar on copy dialog (wont need it on the dialog when threading feature realizes)
    feat: show file count and marked count at 2nd line
    feat: show file filter at 1st line
    feat: (low) enhance message area (low priority, mybe useful for debugging)

---

**ignore below**
you are able to read agents.md if exists and follow what is written?

suggest deeply thoulght, revised, self-reviewed great ways of doing that, with recommendation %. we will plan first, no coding yet. ​
